"use strict";window.abKiteSDK=function(){var e="v0.0.0",t=function(){function t(e){return"complete"===e.readyState?Promise.resolve():new Promise(function(t,i){e.addEventListener("load",t)})}function i(e,i){var a=n(e);if(a){var s=o(a),r=function(){s.contentWindow.postMessage({type:"track-with-ga",val:i},s.src)};t(s).then(r)}}function n(e){return document.getElementById(e)}function o(e){return e.querySelector(".ab-kite-window > iframe")}function a(){var e=navigator.userAgent;return e.search("Mobile")!==-1}function s(e,t){var i="kite-chat-remote-config",n=window.sessionStorage.getItem(i),o=0===window.location.protocol.indexOf("https");if(n)return n=JSON.parse(n),Promise.resolve(n);var a=new Promise(function(a,s){var r=(o?"https://":"http://")+e+"/api/kites/"+t+"/config",l=function(){var e=JSON.parse(this.responseText);e.success?(n=e.kite,a(n),n=JSON.stringify(n),window.sessionStorage.setItem(i,n)):s("Can not load config")},d=function(){s("Can not load config")},c=new XMLHttpRequest;c.addEventListener("load",l),c.addEventListener("error",d),c.open("GET",r),c.send()});return a}function r(e){return s(e.abKiteServer,e.appId).then(function(t){var i=Object.assign({appId:void 0,insert2Selector:"body",abKiteServer:"kite.antbuddy.com",language:"vi",title:"Chúng tôi sẵn sàng hỗ trợ!",position:"",autoOpen:-1,type:"circle",helloMessage:"",logoIcon:void 0,companyName:void 0,wrapperId:void 0,customerName:"",customerEmail:"",customerPhone:"",waitingMsg:void 0,labelFormQuestion:void 0,inputFields:{},coAppIds:[],isInWork:!0,googleAnalyticsTrackingID:void 0},t,e);return i.colors=Object.assign({background:"#98c747",text:"#fff"},t.colors,e.colors),"vn"===i.language&&(i.language="vi"),"left"!==i.position&&(i.position=""),"invisible"!==i.type?(a()&&(i.type="circle"),"circle"===i.type&&(i.helloMessage="")):i.autoOpen=-1,i})}var l=this,d=this;d.appId=void 0,d.abKiteServer=void 0,d.language=void 0,d.title=void 0,d.position=void 0,d.autoOpen=!1,d.type=void 0,d.helloMessage=void 0,d.customerName="",d.customerEmail="",d.customerPhone="",d.waitingMsg=void 0,d.inputFields=void 0,d.coAppIds=[],d.init=function(e){e.abKiteServer=e.abKiteServer||"kite.antbuddy.com",r(e).then(function(e){Object.assign(d,e),d.initABKiteWindow(d.insert2Selector,d.wrapperId)})["catch"](function(e){console.log({Error:e})})},this.buildAbKiteHtml=function(t){var i=l.abKiteServer,n=document.createElement("div");return n.id=t,n.className="ab-kite-wrapper "+l.position,"invisible"!==l.type?n.innerHTML='\n        <link rel="stylesheet" type="text/css" href="//'+i+"/sdk/"+e+'/style.css">\n        <div class="ab-kite-desk '+("circle"===l.type?"":l.type)+' open-icon" onclick="abKiteSDK.showABKiteWindow(\''+t+"'); abKiteSDK.trackWithGA('"+t+"', 'open-kitechat-widget')\">\n          <div title=\""+l.helloMessage+'" class="ab-kite-hellomessage" style="color: '+l.colors.text+';">'+l.helloMessage+'</div>\n          <img class="noselect" src="//'+i+"/sdk/"+e+'/imgs/chat_head.svg"/>\n        </div>\n        <div class="ab-kite-desk '+("circle"===l.type?"":l.type)+' close-icon" style="display: none;" onclick="abKiteSDK.hideABKiteWindow(\''+t+"'); abKiteSDK.trackWithGA('"+t+"', 'hide-kitechat-widget')\">\n          <div title=\""+l.helloMessage+'" class="ab-kite-hellomessage">'+l.helloMessage+'</div>\n          <img src="//'+i+"/sdk/"+e+'/imgs/close_icon.svg"/>\n        </div>\n        <div class="ab-kite-window '+("circle"===l.type?"":l.type)+'">\n          <iframe src="//'+i+'" allowfullscreen></iframe>\n        </div>\n        <div class="ab-kite-show-album" style="display:none;">\n        </div>\n        ':n.innerHTML='\n        <link rel="stylesheet" type="text/css" href="//'+i+"/sdk/"+e+'/style.css">\n        <div class="ab-kite-window kite-invisible">\n          <iframe src="//'+i+'" allowfullscreen></iframe>\n        </div>\n        <div class="ab-kite-show-album" style="display:none;">\n        </div>\n        ',n},this.insertBuiltHtml=function(e,t){var i=document.querySelector(t);return!!i&&(i.appendChild(e),!0)},this.checkFullScreen=function(e){var i,n={headHideButton:i},o=function(){window.innerWidth<480||window.innerHeight<480||"invisible"===l.type?(n.headHideButton=!0,e.contentWindow.postMessage(n,e.src)):(n.headHideButton=!1,e.contentWindow.postMessage(n,e.src))};t(e).then(o)},this.checkResize=function(){var e,t,i=function(i){l.resizeTimer&&clearTimeout(l.resizeTimer),l.resizeTimer=setTimeout(function(){e(t)},150)};return function(n,o){window.removeEventListener("resize",i),t=n,e=o,window.addEventListener("resize",i)}}(),this.showABKiteWindow=function(e){var t=document.getElementById(e),i=t.querySelector(".ab-kite-window > iframe");if(t){var n=document.getElementsByTagName("body")[0];n.classList.add("ab-kite-mobile-fixed");var o=t.getElementsByClassName("ab-kite-window")[0];o.style.display="block",o.classList.add("ab-kite-animated","ab-kite-fadeInUp");var a=t.getElementsByClassName("ab-kite-desk");if(a.length){var s=a[0],r=a[1];r.style.background="#afafaf",s.style.display="none",r.style.display="block"}"invisible"!==l.type&&localStorage.setItem("ab-kite-popup-status","maximize"),l.notifyScaledIframe(i),l.notifyVisibilityIframe(i,"visible")}},this.hideABKiteWindow=function(e){var t=document.getElementById(e),i=t.querySelector(".ab-kite-window > iframe");if(t){var n=document.getElementsByTagName("body")[0];n.classList.remove("ab-kite-mobile-fixed");var o=t.getElementsByClassName("ab-kite-window")[0];o.style.display="none",o.classList.remove("ab-kite-animated","ab-kite-fadeInUp");var a=t.getElementsByClassName("ab-kite-desk");if(a.length){var s=a[0],r=a[1];s.style.background=l.colors.background,s.style.display="block",r.style.display="none"}"invisible"!==l.type&&localStorage.setItem("ab-kite-popup-status","minimize"),l.notifyVisibilityIframe(i,"hidden")}},this.sendDataToApp=function(e){var t=document.getElementById(e);if(t){var i,n=t.querySelector(".ab-kite-window > iframe");l.customerEmail&&(i={name:l.customerName,email:l.customerEmail,phone:l.customerPhone}),window.user&&window.user.chatMucDomain&&(i=window.user);var o={appId:l.appId,abKiteServer:l.abKiteServer,title:l.title,language:l.language,referrer:document.referrer,origin:window.location.href,abUser:window.user&&window.user.chatMucDomain?window.user:void 0,colors:l.colors,waitingMsg:l.waitingMsg,inputFields:l.inputFields,coAppIds:l.coAppIds,labelFormQuestion:l.labelFormQuestion,isInWork:l.isInWork,googleAnalyticsTrackingID:l.googleAnalyticsTrackingID};n.contentWindow.postMessage(o,n.src)}},this.notifyScaledIframe=function(e){var i=(e.style.transform,function(){e.contentWindow.postMessage({type:"scaled-iframe",val:window.getComputedStyle(e).getPropertyValue("transform")},e.src)});t(e).then(i),l.checkResize(e,i)},this.notifyVisibilityIframe=function(e,i){var n=function(){e.contentWindow.postMessage({type:"visibility-iframe",val:i},e.src)};t(e).then(n)},this.refreshIframe=function(e){var t=document.getElementById(e);if(t){l.hideABKiteWindow(e);var i=t.querySelector(".ab-kite-window > iframe"),n=function o(){i.removeEventListener("load",o),i.readyState="complete",l.sendDataToApp(e),l.showABKiteWindow(e)};i.readyState=void 0,i.addEventListener("load",n),i.src=i.src}},this.autoOpenPopup=function(e){var t=localStorage.getItem("ab-kite-popup-status");!isNaN(l.autoOpen)&&l.autoOpen>=0&&"minimize"!==t?setTimeout(function(){l.showABKiteWindow(e)},1e3*l.autoOpen):"maximize"===t&&l.showABKiteWindow(e)},this.showABKiteAlbum=function(e,t,i){var n=document.getElementById(e),o=n.getElementsByClassName("ab-kite-show-album")[0];o.innerHTML='\n        <div class="background-album-show"></div>\n        <div class="wrap-album-show">\n          <img class="" src="'+t+'" alt="'+i+'">\n          <div>\n            <span class="album-title">'+i+"</span>\n          </div>\n        </div>\n      ",o.style.display="block";var a=o.querySelector(".background-album-show");l.addEventOnAlbum(e,a)},this.addEventOnAlbum=function(e,t){var i=l.hideABKiteAlbum;window.focus(),window.addEventListener("keyup",function(t){27===t.keyCode&&i(e)}),t.addEventListener("click",function(t){i(e)})},this.hideABKiteAlbum=function(e){var t=document.getElementById(e),i=t.getElementsByClassName("ab-kite-show-album")[0];i.style.display="none"},this.initABKiteWindow=function(e){var t="ab-kite-wrapper-"+Math.floor(100*Math.random()+1).toString(),i=l.buildAbKiteHtml(t),n=(l.autoShow,i.querySelector(".ab-kite-window > iframe")),o=function s(){l.sendDataToApp(t),n.removeEventListener("load",s),n.readyState="complete",window.addEventListener("message",function(e){if(!(n.src.indexOf(e.origin)<0)){switch(e.data.task){case"refresh_app":l.refreshIframe(t);break;case"hide_app_chat":l.hideABKiteWindow(t);break;case"show_album":l.showABKiteAlbum(t,e.data.src,e.data.title);break;case"hide_album":l.hideABKiteAlbum(t)}}})};if(n.addEventListener("load",o),l.insertBuiltHtml(i,e)){var a=localStorage.getItem("ab-kite-popup-status");l.hideABKiteWindow(t),localStorage.setItem("ab-kite-popup-status",a),window.innerWidth<=991||window.innerHeight<480||l.autoOpenPopup(t)}},this.trackWithGA=i};return new t}(),window.abKiteAsyncInit();